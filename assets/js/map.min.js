$(function(){$.fn.googleMap=function(a){switch(a=$.extend({zoom:10,coords:[48.895651,2.290569],type:"ROADMAP",debug:!1,langage:"english",overviewMapControl:!1,streetViewControl:!1,scrollwheel:!1,mapTypeControl:!1},a),a.type){case"ROADMAP":case"SATELLITE":case"HYBRID":case"TERRAIN":a.type=google.maps.MapTypeId[a.type];break;default:a.type=google.maps.MapTypeId.ROADMAP}return this.each(function(){var b=new google.maps.Map(this,{zoom:a.zoom,center:new google.maps.LatLng(a.coords[0],a.coords[1]),mapTypeId:a.type,scrollwheel:a.scrollwheel,streetViewControl:a.streetViewControl,overviewMapControl:a.overviewMapControl,mapTypeControl:a.mapTypeControl});$(this).data("googleMap",b),$(this).data("googleLang",a.langage),$(this).data("googleDebug",a.debug),$(this).data("googleMarker",new Array),$(this).data("googleBound",new google.maps.LatLngBounds)}),this},$.fn.addMarker=function(a){return a=$.extend({coords:!1,address:!1,url:!1,id:!1,icon:!1,draggable:!1,title:"",text:"",success:function(){}},a),this.each(function(){if($this=$(this),!$this.data("googleMap"))return $this.data("googleDebug")&&console.error("jQuery googleMap : Unable to add a marker where there is no map !"),!1;if(!a.coords&&!a.address)return $this.data("googleDebug")&&console.error("jQuery googleMap : Unable to add a marker if you don't tell us where !"),!1;if(a.address&&"string"==typeof a.address){(function(b){(new google.maps.Geocoder).geocode({address:a.address,bounds:b.data("googleBound"),language:b.data("googleLang")},function(c,d){if(d==google.maps.GeocoderStatus.OK){if(b.data("googleBound").extend(c[0].geometry.location),a.icon)var e=new google.maps.Marker({map:$this.data("googleMap"),position:c[0].geometry.location,title:a.title,icon:a.icon,draggable:a.draggable});else var e=new google.maps.Marker({map:b.data("googleMap"),position:c[0].geometry.location,title:a.title,draggable:a.draggable});if(a.draggable&&google.maps.event.addListener(e,"dragend",function(){var b=e.getPosition(),c={};c.lat=b.lat(),c.lon=b.lng(),a.success(c,$this)}),""==a.title||""==a.text||a.url)a.url&&google.maps.event.addListener(e,"click",function(){document.location=a.url});else{var f=new google.maps.InfoWindow({content:"<h1>"+a.title+"</h1>"+a.text}),g=b.data("googleMap");google.maps.event.addListener(e,"click",function(){f.open(g,e)})}a.id?b.data("googleMarker")[a.id]=e:b.data("googleMarker").push(e),1==b.data("googleMarker").length?(b.data("googleMap").setCenter(c[0].geometry.location),b.data("googleMap").setZoom(b.data("googleMap").getZoom())):b.data("googleMap").fitBounds(b.data("googleBound"));var h={};h.lat=c[0].geometry.location.lat(),h.lon=c[0].geometry.location.lng(),a.success(h,$this)}else $this.data("googleDebug")&&console.error("jQuery googleMap : Unable to find the place asked for the marker ("+d+")")})})($this)}else{if($this.data("googleBound").extend(new google.maps.LatLng(a.coords[0],a.coords[1])),a.icon)var b=new google.maps.Marker({map:$this.data("googleMap"),position:new google.maps.LatLng(a.coords[0],a.coords[1]),title:a.title,icon:a.icon,draggable:a.draggable});else var b=new google.maps.Marker({map:$this.data("googleMap"),position:new google.maps.LatLng(a.coords[0],a.coords[1]),title:a.title,draggable:a.draggable});if(""==a.title||""==a.text||a.url)a.url&&google.maps.event.addListener(b,"click",function(){document.location=a.url});else{var c=new google.maps.InfoWindow({content:"<h1>"+a.title+"</h1>"+a.text}),d=$this.data("googleMap");google.maps.event.addListener(b,"click",function(){c.open(d,b)})}a.draggable&&google.maps.event.addListener(b,"dragend",function(){var c=b.getPosition(),d={};d.lat=c.lat(),d.lon=c.lng(),a.success(d,$this)}),a.id?$this.data("googleMarker")[a.id]=b:$this.data("googleMarker").push(b),1==$this.data("googleMarker").length?($this.data("googleMap").setCenter(new google.maps.LatLng(a.coords[0],a.coords[1])),$this.data("googleMap").setZoom($this.data("googleMap").getZoom())):$this.data("googleMap").fitBounds($this.data("googleBound")),a.success({lat:a.coords[0],lon:a.coords[1]},$this)}}),this},$.fn.removeMarker=function(a){this.each(function(){var b=$(this);if(!b.data("googleMap"))return b.data("googleDebug")&&console.log("jQuery googleMap : Unable to delete a marker where there is no map !"),!1;var c=b.data("googleMarker");return void 0!==c[a]?(c[a].setMap(null),b.data("googleDebug")&&console.log("jQuery googleMap : marker deleted"),!0):(b.data("googleDebug")&&console.error("jQuery googleMap : Unable to delete a marker if it not exists !"),!1)})},$.fn.addWay=function(a){a=$.extend({start:!1,end:!1,step:[],route:!1,langage:"english"},a);var b=new google.maps.DirectionsService({region:"fr"}),c=new google.maps.DirectionsRenderer({draggable:!0,map:$(this).data("googleMap"),panel:document.getElementById(a.route),provideTripAlternatives:!0});document.getElementById.innerHTML="";var d=[];for(var e in a.step){var f;f="object"==typeof a.step[e]?new google.maps.LatLng(a.step[e][0],a.step[e][1]):a.step[e],d.push({location:f,stopover:!0})}if("object"!=typeof a.end){(function(e){(new google.maps.Geocoder).geocode({address:a.end,bounds:e.data("googleBound"),language:a.langage},function(f,g){if(g==google.maps.GeocoderStatus.OK){var h={origin:a.start,destination:f[0].geometry.location,travelMode:google.maps.DirectionsTravelMode.DRIVING,region:"fr",waypoints:d};b.route(h,function(a,b){b==google.maps.DirectionsStatus.OK?c.setDirections(a):e.data("googleDebug")&&console.error("jQuery googleMap : Unable to find the place asked for the route ("+a+")")})}else e.data("googleDebug")&&console.error("jQuery googleMap : Address not found")})})($(this))}else{var g={origin:a.start,destination:new google.maps.LatLng(a.end[0],a.end[1]),travelMode:google.maps.DirectionsTravelMode.DRIVING,region:"fr",waypoints:d};b.route(g,function(a,b){b==google.maps.DirectionsStatus.OK?c.setDirections(a):$(this).data("googleDebug")&&console.error("jQuery googleMap : Address not found")})}return this}}),$(function(){$("#map").googleMap(),$("#map").addMarker({coords:[48.895651,2.290569],title:"Biocop",text:"Magasin bio de ouuuuuuuuuuuuuuuf",url:"www.biocop.fr"}),$("#map").addMarker({coords:[48.869439,2.308664]}),$("#map").addMarker({coords:[48.888846,2.198674]}),$("#form-localization").on("submit",function(){console.log("lkfjkfljgkl"),$("#map").googleMap({zoom:15,type:"SATELLITE"}),$("map").addMarker({address:$("#input-adress").val()})})});